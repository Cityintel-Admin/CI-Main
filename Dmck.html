<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CityIntel — Welcome (Dale)</title>
  <style>

      :root{--brand-red:#D01616;--gray-900:#111214;--gray-800:#16171a;--gray-700:#1c1e22;--gray-600:#24272c;--gray-500:#2e3238;--text:#e9edf2}
      body{margin:0;font:14px/1.5 system-ui;background:linear-gradient(180deg,var(--gray-900),var(--gray-800));color:var(--text)}

     .app{display:grid;grid-template-columns:260px 1fr;grid-template-rows:60px 1fr;grid-template-areas:"sidebar topbar" "sidebar main";min-height:100vh}
    .sidebar{grid-area:sidebar;background:#0c0c0c;border-right:1px solid var(--gray-600);display:flex;flex-direction:column;padding:18px 14px;gap:18px}
      nav a{display:flex;align-items:center;padding:10px 12px;border-radius:10px;text-decoration:none;color:var(--text);border:1px solid transparent}
      nav a:hover{background:var(--gray-600);border-color:var(--gray-500)}
      nav a.active{background:rgba(208,22,22,0.15);border-color:var(--brand-red)}

    .topbar{ grid-area: topbar;background: rgba(255,255,255,0.02);border-bottom:1px solid var(--brand-gray-600);display:flex; align-items:center; gap:12px;
     padding:10px 16px;position:sticky; top:0; z-index:10;backdrop-filter: blur(8px);}

#topActions{margin-left:auto;display:flex; align-items:center; gap:10px;min-width: fit-content;position: relative;}
    
    .user{ display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:12px;
  background:#1c1e22;border:1px solid #24272c;cursor:pointer;
}
    .avatar{ width:28px;height:28px;background:#fff;color:#000;border-radius:50%;
  display:grid;place-items:center;font-weight:700;
}
    .dropdown{ position:absolute;right:0;top:calc(100% + 6px);background:#1a1c20;border:1px solid #24272c;
  border-radius:10px;padding:6px 0;box-shadow:0 4px 12px rgba(0,0,0,.4);display:none;min-width:140px;z-index:50;
}
    .dropdown a{display:block;padding:8px 12px;color:#e9edf2;text-decoration:none;font-size:14px}
    .dropdown a:hover{background:rgba(255,255,255,0.05)}

  .brandbar{display:flex;align-items:center;gap:10px;padding:16px 20px;border-bottom:1px solid var(--line);
    background:linear-gradient(90deg,rgba(208,22,22,.2),rgba(208,22,22,0))}
  .brandbar img{width:auto;height:60px;object-fit:contain;border-radius:6px;background:#fff}



    #trial-banner{
      flex:1;
      text-align:center;
      font-size:12px;
      font-weight:600;
      color:#fecaca;
    }


    .logout-link{
      color:#8e97a3;
      font-size:12px;
    }

    .main{
      grid-area:main;
      padding:18px;
    }

    .page-head{
      display:flex;
      align-items:flex-start;
      flex-wrap:wrap;
      gap:12px;
      margin-bottom:16px;
    }
    .page-head-left h2{
      margin:0;
      font-size:16px;
      font-weight:600;
      color:var(--text);
    }
    .page-head-left .sub{
      font-size:12px;
      color:var(--muted);
      line-height:1.4;
    }
    .page-head-right{
      margin-left:auto;
      display:flex;
      flex-direction:column;
      align-items:center;
      min-width:160px;
      gap:8px;
    }


.page-title-bar{
  display:flex;
  align-items:flex-start;
  gap:10px;
  margin-bottom:12px;
}

.page-title-main{
  display:flex;
  flex-direction:column;
  gap:4px;
}

.page-title-bar h2{
  margin:0;
  font-size:18px;
  font-weight:600;
  color:var(--text);
}

.page-title-sub{
  font-size:12px;
  color:#8e97a3; /* muted */
}

.page-title-actions{
  margin-left:auto;
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}

.btn-outline-pill{
  border-radius:999px;
  border:1px solid var(--gray-600);
  background:#1f2024;
  color:#e9edf2;
  font-size:12px;
  font-weight:500;
  padding:6px 12px;
  cursor:pointer;
  text-decoration:none;
  display:inline-flex;
  align-items:center;
  gap:6px;
  white-space:nowrap;
}

.btn-outline-pill:hover{
  background:#2a2d32;
  border-color:#D01616;
  color:#fff;
}


	  

    .btn-red{
      background:#D01616;
      color:#fff;
      font-size:13px;
      font-weight:600;
      border:1px solid #D01616;
      border-radius:10px;
      padding:8px 12px;
      cursor:pointer;
      line-height:1.2;
      text-align:center;
      min-width:140px;
    }
    .btn-red:hover{
      background:#ff2a2a;
      border-color:#ff2a2a;
    }

    .feeds-grid{
  display: grid;
  gap: 16px;
  /* default: responsive 1–2 columns */
  grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
}

/* On wider screens, force 3 equal columns */
@media (min-width: 1280px){
  .feeds-grid{
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }
}


    .feed-card{
      background:linear-gradient(180deg,#1a1c20,#131417);
      border:1px solid var(--g600);
      border-radius:16px;
      display:flex;
      flex-direction:column;
      min-height:260px;
      max-height:400px;
    }

    .feed-head{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      border-bottom:1px solid var(--g600);
      padding:12px 16px;
    }
    .feed-head-left{
      font-size:13px;
      color:var(--text);
      line-height:1.4;
    }
    .feed-city{
      font-weight:600;
      font-size:14px;
      color:#fff;
    }

    .feed-head-meta{
      margin-top:4px;
      font-size:11px;
      color:#9ca3af;
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      align-items:center;
    }

    .feed-head-meta span.badge{
      padding:2px 6px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.45);
      background:rgba(15,23,42,.8);
      font-size:10px;
      text-transform:uppercase;
      letter-spacing:.03em;
    }

	  
    .feed-risk{
      display:inline-block;
      font-size:11px;
      line-height:1.2;
      font-weight:600;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.15);
    }
    .feed-risk.high{
      background:rgba(255,90,95,.12);
      border-color:rgba(255,90,95,.35);
      color:#ff5a5f;
    }
    .feed-risk.med{
      background:rgba(240,180,41,.12);
      border-color:rgba(240,180,41,.35);
      color:#f0b429;
    }
    .feed-risk.low{
      background:rgba(51,196,141,.12);
      border-color:rgba(51,196,141,.35);
      color:#33c48d;
    }
    .feed-head-right{
      display:flex;
      flex-direction:column;
      align-items:flex-end;
      gap:4px;
    }

/* Helps remove thin gaps/bands between raster tiles */
.leaflet-container { background: #b9d7ea; } /* any light ocean-ish colour */
.leaflet-tile {
  outline: 1px solid transparent;           /* forces consistent compositing */
  transform: translate3d(0,0,0);
  backface-visibility: hidden;
}


	  
	.feed-kw{
     margin-top:4px;
     font-size:12px;
     color:var(--muted);
     white-space:nowrap;
     overflow:hidden;
     text-overflow:ellipsis;
     max-width: 100%;
    }

	  .live-map-feed-label{
  font-size:12px;
  font-weight:600;
  color:#e5e7eb;
  margin-bottom:4px;
}

.live-map-feed-counts{
  display:flex;
  gap:8px;
  align-items:center;
  font-size:11px;
  color:#cbd5e1;
}
.live-map-feed-counts .dot{
  width:6px;height:6px;border-radius:999px;display:inline-block;margin-right:4px;
}
.live-map-feed-counts .dot-high{ background:#ff5a5f; }
.live-map-feed-counts .dot-med { background:#f0b429; }
.live-map-feed-counts .dot-low { background:#33c48d; }


/* --- Alerts panel layout + scrolling --- */
#mapAlertsPanel{
  display:none;                 /* JS toggles this */
  flex-direction:column;
  gap:8px;
  height:100%;
  min-height:0;                 /* critical so inner scroller works */
}

#mapAlertsList{
  flex:1;
  min-height:0;
  overflow:auto;
  padding-right:10px;           /* avoids scrollbar overlap */
}

/* keep Back button visible and not covering the scrollbar */
#mapAlertsBackBtn{
  position:sticky;
  bottom:0;
  z-index:2;
  margin-top:6px;
}
	  
.kw-chip{
  display:inline-block;
  padding:2px 6px;
  border:1px solid var(--g600);
  border-radius:999px;
  font-size:11px;
  color:#cfd6df;
  background:#1f2024;
  margin-right:6px;
}
.kw-more{
  font-size:11px;
  opacity:.8;
}


/* ---------------------------------------------------------
   RECENCY AGE VISUALS
--------------------------------------------------------- */

.age-fresh {
  opacity: 1;
  border-color: #3f3f3f !important;
}

.age-recent {
  opacity: 0.85;
  border-color: #333 !important;
}

.age-older {
  opacity: 0.65;
  border-color: #262626 !important;
}

.age-stale {
  opacity: 0.45;
  border-color: #1e1e1e !important;
}
	  
 
	  
/* LIVE badge in feed header */
    .live-pill {
      display:inline-flex;
      align-items:center;
      gap:6px;
      background:rgba(208,22,22,0.15);
      border:1px solid #D01616;
      color:#ff4d4d;
      font-size:11px;
      font-weight:600;
      line-height:1.2;
      padding:3px 8px;
      border-radius:999px;
    }
    .live-dot {
      width:6px;
      height:6px;
      border-radius:50%;
      background:#ff4d4d;
      box-shadow:0 0 6px #ff4d4d,0 0 10px #ff4d4d;
    }

    /* checkbox row in modal */
    .modal-row-inline {
      display:flex;
      align-items:center;
      gap:8px;
      font-size:12px;
      color:var(--muted);
      line-height:1.4;
      margin-bottom:12px;
    }
    .modal-row-inline input[type="checkbox"] {
      margin-top:2px;
      accent-color:#D01616; /* modern browsers */
    }
    .modal-row-inline .live-row-text {
      color:#fff;
      font-size:13px;
      line-height:1.4;
    }
    .modal-row-inline .live-row-hint {
      font-size:11px;
      color:var(--muted);
      line-height:1.4;
    }

	  
	  
    .btn-ghost{
      background:#1f2024;
      color:#e9edf2;
      border:1px solid var(--g600);
      border-radius:8px;
      padding:4px 8px;
      font-size:12px;
      line-height:1.2;
      cursor:pointer;
    }
    .btn-ghost:hover{
      background:#2a2d32;
    }

    .feed-body{
      flex:1;
      overflow-y:auto;
      padding:12px 16px 16px;
      font-size:13px;
    }
    .feed-item{
      border-left:4px solid #D01616;
      background:linear-gradient(90deg,rgba(208,22,22,.1),rgba(208,22,22,0));
      border-radius:8px;
      border:1px solid var(--g600);
      padding:10px 12px;
      margin-bottom:10px;
      cursor:pointer;
    }
    .feed-item:last-child{
      margin-bottom:0;
    }
    .feed-title-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
      gap:8px;
      font-size:13px;
      font-weight:600;
      color:#fff;
    }
    .feed-meta{
      font-size:11px;
      color:var(--muted);
      line-height:1.4;
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }

    .feed-footer{
      border-top:1px solid var(--g600);
      padding:10px 16px;
      font-size:11px;
      color:var(--muted);
      display:flex;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .feed-footer .src{
      color:var(--muted);
    }
    .feed-footer .refresh{
      cursor:pointer;
      color:#8e97a3;
    }
    .feed-footer .refresh:hover{
      color:#fff;
    }

    /* slide-in detail panel */
    .detail-panel{
      position:fixed;
      top:0;
      right:0;
      height:100vh;
      width:360px;
      max-width:80%;
      background:#1a1c20;
      border-left:1px solid var(--g600);
      box-shadow:-20px 0 40px rgba(0,0,0,.8);
      color:#e9edf2;
      font-size:13px;
      line-height:1.5;
      display:flex;
      flex-direction:column;
      transform:translateX(100%);
      transition:transform .25s ease;
      z-index:10000;
    }
    .detail-panel.open{
      transform:translateX(0%);
    }

    .detail-head{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      padding:16px;
      border-bottom:1px solid var(--g600);
      background:#131417;
    }
    .detail-head-left{
      max-width:260px;
    }
    .detail-title{
      font-size:14px;
      font-weight:600;
      color:#fff;
      margin-bottom:4px;
    }
    .detail-meta{
      font-size:12px;
      color:var(--muted);
      line-height:1.4;
    }
    .detail-close{
      background:none;
      border:0;
      color:#8e97a3;
      font-size:12px;
      cursor:pointer;
      padding:4px 6px;
      border-radius:6px;
    }
    .detail-close:hover{
      color:#fff;
      background:#2a2d32;
    }

    .detail-body{
      flex:1;
      overflow-y:auto;
      padding:16px;
    }
    .detail-section{
      margin-bottom:16px;
      background:linear-gradient(180deg,#1a1c20,#131417);
      border:1px solid var(--g600);
      border-radius:12px;
      padding:12px;
    }
    .detail-section h4{
      margin:0 0 6px;
      font-size:12px;
      font-weight:600;
      color:#fff;
      text-transform:uppercase;
      letter-spacing:.03em;
    }
    .detail-section .small{
      font-size:12px;
      color:var(--muted);
      line-height:1.4;
    }

    .detail-footer{
      border-top:1px solid var(--g600);
      background:#131417;
      padding:12px 16px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .earlier-list {
  margin: 0;
  padding-left: 18px;
  list-style: disc;
  line-height: 1.4;
  gap: 4px;
}
    .earlier-list li {
  margin-bottom: 4px;
}


.event-group {
  background: #1a1a1a;
  padding: 14px;
  border-radius: 10px;
  margin-bottom: 10px;
  border: 1px solid #2a2a2a;
}

.eg-header {
  display: flex;
  justify-content: space-between;
  cursor: pointer;
  align-items: center;
}

.eg-title {
  font-size: 15px;
  font-weight: 600;
  display: flex;
  gap: 8px;
  align-items: center;
}

.eg-icon {
  display: inline-flex;
  width: 22px;
  height: 22px;
  border-radius: 6px;
  background: #333;
  justify-content: center;
  align-items: center;
  font-size: 12px;
  font-weight: 700;
}

.eg-meta {
  display: flex;
  gap: 10px;
  font-size: 13px;
  opacity: 0.9;
}

.eg-sub {
  margin-top: 3px;
  font-size: 12px;
  opacity: 0.85;
  display: flex;
  gap: 12px;
}

.eg-when {
  opacity: 0.85;
}

	  
.eg-body {
  margin-top: 12px;
  padding-left: 8px;
  border-left: 2px solid #333;
  max-height: 140px;      /* adjust if you want more/less */
  overflow-y: auto;
}

.eg-item {
  margin-bottom: 9px;
}

.eg-item-when {
  font-size: 12px;
  opacity: 0.7;
}

.eg-item-text {
  font-size: 13px;
  line-height: 1.3;
  display: -webkit-box;
  -webkit-line-clamp: 3;     /* show up to 3 lines */
  -webkit-box-orient: vertical;
  overflow: hidden;
}
	.eg-footer {
  margin-top: 8px;
  text-align: right;
}
.eg-footer .eg-view-btn {
  font-size: 11px;
  padding: 4px 8px;
}  


/* --- Global "Now" strip above feeds --- */
.live-now-strip{
  margin: 10px 0 14px;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid var(--g600);
  background: linear-gradient(90deg, rgba(208,22,22,.14), rgba(12,10,20,.9));
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 8px;
  font-size: 12px;
}

.live-now-label{
  font-weight: 600;
  color: #fecaca;
  text-transform: uppercase;
  letter-spacing: .06em;
  font-size: 11px;
}

.live-now-stats{
  color: #e5e7eb;
  opacity: .9;
}

.live-now-stats span{
  margin-right: 6px;
}

.live-now-stats .dot-high{ color:#f97373; }
.live-now-stats .dot-med { color:#fbbf24; }
.live-now-stats .dot-low { color:#4ade80; }

.live-now-pills{
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  margin-left:auto;
}

.live-now-pill{
  border-radius:999px;
  border:1px solid rgba(248,113,113,.7);
  background:rgba(127,29,29,.9);
  color:#fee2e2;
  font-size:11px;
  padding:4px 8px;
  cursor:pointer;
  display:inline-flex;
  align-items:center;
  gap:4px;
  white-space:nowrap;
}

.live-now-pill span:first-child{
  font-size:13px;
}

.live-now-pill:hover{
  filter:brightness(1.1);
}

.live-now-empty{
  font-size:12px;
  color:#9ca3af;
}



	  
	  
    .btn-full-incident{
      background:#D01616;
      color:#fff;
      border:1px solid #D01616;
      border-radius:10px;
      padding:10px 12px;
      font-size:13px;
      font-weight:600;
      line-height:1.2;
      text-align:center;
      text-decoration:none;
      cursor:pointer;
    }
    .btn-full-incident:hover{
      background:#ff2a2a;
      border-color:#ff2a2a;
    }

    .btn-back-dash{
      display:inline-block;
      text-decoration:none;
      color:#ff5a5f;
      font-size:12px;
      font-weight:600;
      text-align:center;
    }

    /* Add Feed modal */
    .modal-overlay{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.6);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:10001;
    }
    .modal-box{
      background:#1a1c20;
      border:1px solid var(--g600);
      border-radius:16px;
      width:420px;
      max-width:90%;
      box-shadow:0 30px 60px rgba(0,0,0,.9);
      padding:16px;
      color:var(--text);
      font-size:13px;
    }
    .modal-box h3{
      margin:0 0 12px;
      font-size:14px;
      font-weight:600;
      color:#fff;
    }
    .modal-row{
      margin-bottom:12px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .modal-row label{
      font-size:12px;
      color:var(--muted);
    }
    .modal-row input, .modal-row select{
      background:#1f2024;
      border:1px solid var(--g600);
      border-radius:8px;
      color:#fff;
      padding:10px 12px;
      font-size:14px;
      line-height:1.4;
      outline:none;
      width:90%;
    }
    .modal-row input:focus,
    .modal-row select:focus{
      border-color:#D01616;
    }
    .modal-actions{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
    }
    .btn-cancel{
      background:#1f2024;
      border:1px solid var(--g600);
      border-radius:8px;
      color:#8e97a3;
      font-size:12px;
      line-height:1.2;
      padding:8px 10px;
      cursor:pointer;
      flex:1;
      text-align:center;
    }
    .btn-cancel:hover{
      background:#2a2d32;
      color:#fff;
    }
    .btn-save{
      background:#D01616;
      border:1px solid #D01616;
      border-radius:8px;
      color:#fff;
      font-size:12px;
      font-weight:600;
      line-height:1.2;
      padding:8px 10px;
      cursor:pointer;
      flex:1;
      text-align:center;
    }
    .btn-save:hover{
      background:#ff2a2a;
      border-color:#ff2a2a;
    }


	  /* Card that holds the live map */
.live-map-card{
  position: relative;
  padding: 16px 18px 20px;
}
	  



/* Map + sidebar layout */
.live-map-shell{
  display:flex;
  gap:14px;
  align-items:stretch;
}

.live-map-main{
  flex:1;
  height:480px;          /* tweak: taller map */
  border-radius:14px;
  overflow:hidden;
}

/* Right-hand column */
.live-map-sidebar{
  width:250px;
  background:#05070b;
  border-radius:14px;
  border:1px solid #2e3238;
  padding:10px 12px;
  font-size:11px;
  color:#e5e7eb;
  display:flex;
  flex-direction:column;
  gap:10px;
}

/* Legend block */
.live-map-legend-block{
  border-radius:10px;
  background:#06070c;
  padding:8px 10px;
  border:1px solid #2e3238;
}

.live-map-legend-row{
  display:flex;
  align-items:center;
  gap:6px;
  margin-bottom:4px;
}

.live-map-legend-row:last-child{
  margin-bottom:0;
}

.live-map-chip{
  width:12px;
  height:12px;
  border-radius:3px;
  border:1px solid #111827;
}

.live-map-chip-high{ background:#ff5a5f; }
.live-map-chip-med { background:#f0b429; }
.live-map-chip-low { background:#6bcf6b; }

.live-map-dot{
  width:9px;
  height:9px;
  border-radius:999px;
  display:inline-block;
}

.live-map-dot-asset{ background:#3b82f6; }
.live-map-dot-trav { background:#f97316; }

/* Feeds area */
.live-map-sidebar-section{
  border-radius:10px;
  background:#05070b;
  border:1px solid #111827;
  padding:8px 8px 10px;
}

.live-map-sidebar-title{
  font-size:10px;
  letter-spacing:.06em;
  text-transform:uppercase;
  opacity:.75;
  margin-bottom:6px;
}

.live-map-feeds-list{
  display:flex;
  flex-direction:column;
  gap:4px;
  max-height:160px;
  overflow-y:auto;
}

.live-map-feed-row{
  width:100%;
  text-align:left;
  border-radius:12px;
  border:1px solid #374151;
  background:#0b1120;
  color:#e5e7eb;
  padding:8px 10px;
}

.live-map-feed-row:hover{
  background:#111827;
  border-color:#4b5563;
}
	  
	  
.live-map-feed-btn,
.gm-feed-pill{
  cursor: pointer;
  user-select: none;
  -webkit-user-select: none;
}

.live-map-feed-btn:hover{
  background:#1f2937;
  border-color:#9ca3af;
}

.live-map-add-btn{
  margin-top:8px;
  width:100%;
  border-radius:999px;
  border:1px dashed #4b5563;
  background:#05070b;
  color:#e5e7eb;
  font-size:11px;
  padding:4px 6px;
  cursor:pointer;
}

.live-map-add-btn:hover{
  background:#111827;
}

/* highlight when sidebar scrolls you to a feed card */
.feed-card-pulse{
  box-shadow:0 0 0 2px rgba(248,113,113,.8);
  transition:box-shadow .3s ease;
}



.live-radius-block{
  margin-top:12px;
  padding-top:8px;
  border-top:1px solid #2e3238;
}

.live-radius-label{
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:.08em;
  color:#9ca3af;
  margin-bottom:6px;
}

.live-radius-pills{
  display:flex;
  gap:6px;
}

.radius-pill{
  flex:1;
  border-radius:999px;
  border:1px solid #4b5563;
  background:#111827;
  color:#e5e7eb;
  font-size:11px;
  padding:4px 0;
  cursor:pointer;
  text-align:center;
}

.radius-pill.active{
  border-color:#f97373;
  background:#7f1d1d;
  color:#fee2e2;
}


	/* --- Map sidebar: selected feed alerts list --- */
.map-alerts-list{
  display:flex;
  flex-direction:column;
  gap:8px;
  max-height:240px;     /* adjust if you want */
  overflow-y:auto;
  padding-right:2px;
}

.map-alert-item{
  border-radius:12px;
  border:1px solid #374151;
  background:#0b1120;
  padding:8px 10px;
  cursor:pointer;
}

.map-alert-item:hover{
  background:#111827;
  border-color:#4b5563;
}

.map-alert-top{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:8px;
  margin-bottom:6px;
}

.map-alert-title{
  font-size:12px;
  font-weight:600;
  color:#e5e7eb;
  line-height:1.25;
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
}

.map-alert-when{
  font-size:11px;
  opacity:.75;
  white-space:nowrap;
}

.map-alert-meta{
  display:flex;
  gap:6px;
  flex-wrap:wrap;
  align-items:center;
  font-size:11px;
  opacity:.9;
}

.map-risk-pill{
  font-size:10px;
  font-weight:700;
  padding:2px 8px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.15);
}

.map-risk-high{ background:rgba(255,90,95,.14); border-color:rgba(255,90,95,.35); color:#ff5a5f; }
.map-risk-med { background:rgba(240,180,41,.14); border-color:rgba(240,180,41,.35); color:#f0b429; }
.map-risk-low { background:rgba(51,196,141,.14); border-color:rgba(51,196,141,.35); color:#33c48d; }

.map-alert-empty{
  font-size:12px;
  opacity:.75;
  padding:8px 2px;
}
  
	  

/* brief highlight when we jump to a feed card */
.feed-card-pulse{
  box-shadow:
    0 0 0 1px #f97316,
    0 0 10px rgba(249,115,22,0.7);
  transition: box-shadow .3s ease;
}


	  /* --- Global Risk & Exposure layout --- */
.global-map-wrap{
  margin-top: 10px;
  padding: 12px 14px 16px;
  display: grid;
  grid-template-columns: minmax(260px, 320px) minmax(0, 1fr); /* sidebar | map */
  gap: 16px;
  align-items: stretch;
}

.global-map-main{
  background:#020617;
  border-radius:16px;
  overflow:hidden;
  border:1px solid var(--gray-700);
  grid-column: 2;	
}

:root{
  --workspace-h: clamp(440px, 62vh, 720px);

	  
/* This is critical – gives the Leaflet container height */
#liveRiskMap{
  width:100%;
  height: var(--workspace-h);
  background:#cfe3f3;
  filter: saturate(1.05) contrast(1.05);
}

#liveMapFeedsList { max-height: 260px; overflow:auto; }

	  
/* Right-hand side panel */
.global-map-side{
  background:#050708;
  border-radius:16px;
  border:1px solid var(--gray-700);
  padding:12px 14px;
  font-size:12px;
  height: var(--workspace-h);
  display:flex;
  flex-direction:column;
  gap:12px;
  grid-column: 1;	
  overflow: hidden;
}

/* Make the alerts panel a proper column layout */
.map-alerts-scroll{
  flex:1;
  overflow-y:auto;
  padding-right:6px; /* space for scrollbar */
}

/* Footer stays visible */
.map-alerts-footer{
  border-top:1px solid #2e3238;
  padding:8px;
  background:#05070b;
}

/* Back button styling */
.map-back-btn{
  width:100%;
  border-radius:999px;
  border:1px solid #4b5563;
  background:#111827;
  color:#e5e7eb;
  font-size:12px;
  padding:6px 0;
  cursor:pointer;
}

.map-back-btn:hover{
  background:#1f2937;
}

/* The list should scroll, not the whole panel */
#mapAlertsList{
  flex:1;
  padding-bottom: 44px;
  overflow-y:auto;
  max-height:none; /* override earlier max-height if set */
}

/* Keep the Back button always visible */
#mapAlertsBackBtn{
  position: sticky;
  bottom: 0;
  margin-top: 8px;
  background: #05070b;           /* match panel bg */
  border: 1px dashed #4b5563;
  border-radius: 999px;
}



	  
/* Legend styling */
.global-map-legend-block{
  border-bottom:1px solid #2e3238;
  padding-bottom:8px;
}
.gm-legend-title{
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:.08em;
  opacity:.8;
  margin-bottom:6px;
}
.gm-legend-row{
  display:flex;
  align-items:center;
  gap:6px;
  margin-bottom:3px;
}
.gm-chip{
  width:12px;
  height:12px;
  border-radius:3px;
  border:1px solid #111827;
}
.gm-high{ background:#ff5a5f; }
.gm-med{  background:#f0b429; }
.gm-low{  background:#6bcf6b; }

.gm-dot{
  width:10px;
  height:10px;
  border-radius:999px;
  display:inline-block;
}
.gm-asset{ background:#3b82f6; }
.gm-trav{  background:#f97316; }

/* Feed list inside side panel */
.global-map-feeds-block{
  margin-top:4px;
}
.gm-feeds-title{
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:.08em;
  opacity:.75;
  margin-bottom:6px;
}
.gm-feed-pill{
  width:100%;
  text-align:left;
  border-radius:999px;
  border:1px solid #374151;
  background:#0b1120;
  color:#e5e7eb;
  font-size:12px;
  padding:5px 8px;
  margin-bottom:4px;
  cursor:pointer;
}
.gm-feed-pill:hover{
  background:#111827;
  border-color:#4b5563;
}
.gm-feed-add{
  width:100%;
  margin-top:4px;
  border-radius:999px;
  border:1px solid #4b5563;
  background:#111827;
  color:#e5e7eb;
  font-size:11px;
  padding:5px 8px;
  cursor:pointer;
}
.gm-feed-add:hover{
  background:#1f2937;
}

/* subtle highlight when a feed is jumped to */
.feed-card-highlight{
  box-shadow:0 0 0 2px rgba(248,113,113,.7);
  transition:box-shadow .25s ease;
}

	  
#liveFeedSection{
  display:none !important;
}

	  
/* asset / traveller markers */
.ci-asset-marker,
.ci-trav-marker{
  background:#111827;
  border-radius:999px;
  border:2px solid #000;
  box-shadow:0 0 6px rgba(0,0,0,0.6);
  color:#fff;
  font-size:10px;
  font-weight:700;
  line-height:18px;
  text-align:center;
}
.ci-asset-marker{ background:#3b82f6; }    /* blue */
.ci-trav-marker{ background:#f97316; }    /* orange */


	  

    @media (max-width:900px){
      .app{
        grid-template-columns:1fr;
        grid-template-areas:
          "topbar"
          "main";
      }
      .sidebar{
        display:none;
      }
      .detail-panel{
        width:80%;
        max-width:400px;
      }
    }


@media (max-width: 1100px){
  .global-map-wrap{
    grid-template-columns: 1fr;
  }
  .global-map-side{
    grid-column: 1;
    height: auto;
    max-height: none;
  }
  .global-map-main{
    grid-column: 1;
  }
  #liveRiskMap{
    height: clamp(380px, 55vh, 560px);
  }
}


	
  
  
  /* Dale welcome improvements */
  .steps{margin:0; padding-left:18px;}
  .steps li{margin:8px 0;}
  .page-title h1{margin:0 0 10px; font-size:34px; letter-spacing:.2px;}
  .page-title .sub{max-width:980px; line-height:1.6;}

</style>
</head>
<body>
  <div class="brandbar">
  <img src="CityintLogo.jpg" alt="CityIntel Logo">
  <div class="title" style="font-weight:700;font-size:18px">CityIntel</div>

  <div id="trial-banner" style="display:none;position:absolute;
       left:50%; transform:translateX(-50%); background:none;
       color:#fecaca; padding:8px 12px; text-align:center;">
    <span id="trial-text">Your trial ends soon.</span>
  </div>

  <!-- keep topActions INSIDE the brandbar -->
  <div id="topActions" style="position:relative;margin-left:auto"></div>
</div>
		

	
  <div class="app">
    <aside class="sidebar">
       <div class="section-label"></div>
      <nav>
        <a href="index.html">Dashboard</a>
        <a href="assets.html">Assets</a>
		<a href="travellers.html">Travellers</a>  
        <a href="alerts.html">Alerts</a>
        <a href="events.html">Events</a>
		<a href="test.html">Live Feed/ Test Page</a>
	<a href="brief.html">Intelligence Brief</a>
	    <a href="reports.html">Reports</a>
	<a href="trends.html">Trends & Forecasts</a>
		<a href="sources.html">Sources</a>
        <a href="settings.html">Settings</a>
        <a href="about.html">About</a>
      </nav>
      <div class="footnote">For information use only — not for redistribution</div>
    </aside>
  <main class="main">
    <div class="wrap">
  <header class="page-title">
    <h1>Welcome, Dale</h1>
    <p class="sub">
      CityIntel is an incident‑intelligence dashboard that helps you quickly see what’s happening, where it’s happening,
      and whether your organisation’s <strong>assets</strong> (sites/offices) or <strong>travellers</strong> could be exposed.
      Some modules are production‑ready today; others are being actively developed (you can still explore them with mock feeds).
    </p>
  </header>

  <section class="card">
    <h2>How to use CityIntel in 60 seconds</h2>
    <ol class="steps">
      <li><strong>Start on Dashboard</strong> to get a global risk snapshot and a quick “what’s live now” view.</li>
      <li><strong>Check Assets / Travellers</strong> to confirm your organisation’s locations and people are up to date.</li>
      <li><strong>Open Alerts</strong> for the newest items (triage), then click through to the incident details panel.</li>
      <li><strong>Use Events</strong> for higher‑level tracking and history (useful when incidents evolve over days).</li>
      <li><strong>Live Feed / Test Page</strong> shows the in‑progress real‑time experience (feeds, map centring, exposure overlay).</li>
    </ol>
  </section>

  <section class="card">
    <h2>What each page does</h2>
    <div class="grid">
      <div class="grid-col">
        <h3>Dashboard</h3>
        <ul>
          <li><strong>Global Risk & Live Exposure</strong> summary bar (high/med/low counts “now”).</li>
          <li><strong>Risk shading</strong> for a longer window (currently built around ~6 months of historical signals).</li>
          <li>Quick access to <strong>Manage assets</strong> and <strong>Manage travellers</strong>.</li>
        </ul>

        <h3>Assets</h3>
        <ul>
          <li>Maintain offices/sites with coordinates and metadata.</li>
          <li>Assets are checked against incidents to flag potential exposure.</li>
        </ul>

        <h3>Travellers</h3>
        <ul>
          <li>Maintain traveller locations / itineraries (hotel, city, dates where available).</li>
          <li>Travellers are overlaid on the map and matched to incidents by proximity.</li>
        </ul>

        <h3>Alerts</h3>
        <ul>
          <li>Newest alert stream for fast triage.</li>
          <li>Includes protest / unrest‑type items as well as disruptions (transport, public safety, etc.).</li>
          <li>Designed around a rolling history (often 1–2+ months depending on source/window).</li>
        </ul>

        <h3>Events</h3>
        <ul>
          <li>Higher‑level event tracking, timelines, and “what changed since last update”.</li>
          <li>Useful for longer incidents (multi‑day protests, escalating disruptions, repeat alerts).</li>
        </ul>
      </div>

      <div class="grid-col">
        <h3>Live Feed / Test Page (development)</h3>
        <ul>
          <li>Real‑time feeds by city/region with <strong>click‑to‑open</strong> incident detail panel.</li>
          <li>Map centres on the incident city and overlays nearby assets/travellers (when configured).</li>
          <li>You can add/remove feeds instantly and test with <strong>mock feeds</strong> to preview the final experience.</li>
        </ul>

        <h3>Intelligence Brief</h3>
        <ul>
          <li>Structured analytical reporting (not a live alert stream).</li>
          <li>Regional situation summaries, escalation outlooks, security forecasts and operational advisories (where enabled).</li>
        </ul>

        <h3>Reports</h3>
        <ul>
          <li>Export and reporting views (PDF/CSV-style outputs where enabled).</li>
          <li>Typically used for sharing with stakeholders and audit packs.</li>
        </ul>

        <h3>Trends & Forecasts</h3>
        <ul>
          <li>Longer‑window patterns for planning (risk trends by geography/category).</li>
          <li>Supports decisions like route changes, staffing advisories, and asset protection.</li>
        </ul>

        <h3>Sources</h3>
        <ul>
          <li>Where data providers and source settings are configured (where enabled).</li>
          <li>Used to control coverage, filters, and which feeds appear across the platform.</li>
        </ul>
      </div>
    </div>
  </section>

  <section class="card">
    <h2>Settings, analytics, and governance</h2>
    <div class="grid">
      <div class="grid-col">
        <h3>Settings</h3>
        <ul>
          <li>Account and subscription controls (billing portal where enabled).</li>
          <li>Organisation configuration and environment options.</li>
          <li>Includes the entry point to optional tools such as the <strong>Panic Alarm</strong> download/link (if enabled for your org).</li>
        </ul>

        <h3>Operations Log</h3>
        <ul>
          <li>Audit trail of key actions (adds/removes, triage notes, configuration changes).</li>
        </ul>
      </div>

      <div class="grid-col">
        <h3>Analytics</h3>
        <ul>
          <li>Performance and activity views (incident volumes, risk distribution, geographic patterns).</li>
          <li>Useful for weekly/monthly reporting and seeing whether risk is rising or falling by region.</li>
        </ul>

        <h3>About / System Flow</h3>
        <ul>
          <li>High‑level explanation of what CityIntel is and how data flows through the platform.</li>
          <li>Helpful when onboarding new users or explaining the system to stakeholders.</li>
        </ul>
      </div>
    </div>
  </section>

  <section class="card">
    <h2>Need help?</h2>
    <p>
      If you need access changes, feed coverage adjustments, or operational guidance on how your organisation should use CityIntel day‑to‑day,
      please speak with <strong>Morris</strong>.
    </p>
  </section>
</div></div>
  </main>

  <!-- Optional: keep the same auth gate as other admin pages -->
  <script src="auth.js"></script>
  <script src="admin-links.js"></script>
</body>
</html>
